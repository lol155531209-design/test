<!DOCTYPE html>

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<title>é«˜æ ¡-ä¼ä¸šåˆä½œåœ°å›¾å±•ç¤º</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>
    :root{
      --bg:#0b1220; --panel:#111726; --card:#151d2f; --text:#e7eefc; --muted:#9fb2d9; --brand:#49d1ff;
      --border:#23304a; --accent:#79ffe1;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font:14px/1.5 system-ui,-apple-system,"Segoe UI",Roboto,"PingFang SC","Microsoft YaHei",sans-serif}
    .wrap{display:grid;grid-template-columns:1fr 0;grid-template-areas:"map panel";height:100%}
    #map{grid-area:map}
    #map,#echarts{height:100%}
    .topbar{
      position:absolute;left:16px;top:16px;z-index:10;background:rgba(17,23,38,.7);backdrop-filter:blur(6px);
      border:1px solid var(--border);border-radius:14px;padding:10px 12px;box-shadow:0 10px 30px rgba(0,0,0,.25)
    }
    .topbar h1{margin:0;font-size:16px}
    .hint{margin:6px 0 0;color:var(--muted);font-size:12px}
    /* side panel */
    .panel{
      grid-area:panel;width:420px;max-width:90vw;height:100%;background:var(--panel);border-left:1px solid var(--border);
      position:fixed;right:0;top:0;transform:translateX(100%);transition:transform .28s ease;z-index:20;
      display:flex;flex-direction:column
    }
    .panel.open{transform:translateX(0)}
    .panel header{display:flex;align-items:center;gap:8px;padding:14px 16px;border-bottom:1px solid var(--border)}
    .panel header .title{font-weight:700}
    .panel header .crumb{color:var(--muted)}
    .panel .content{padding:12px 16px;overflow:auto;flex:1}
    .panel .search{position:sticky;top:0;background:var(--panel);padding-bottom:8px}
    .panel input{
      width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#0f1523;color:var(--text)
    }
    .uni-list{display:grid;grid-template-columns:1fr;gap:10px;margin-top:10px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px}
    .card h3{margin:0 0 6px;font-size:15px}
    .meta{color:var(--muted);font-size:12px}
    .btns{display:flex;gap:8px;margin-top:10px}
    .btn{
      padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:#0e1626;color:var(--text);
      cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:6px
    }
    .btn.primary{border-color:#2a3c63;background:#14223b;box-shadow:0 6px 20px rgba(73,209,255,.15)}
    .btn:hover{border-color:#3a5287}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--border);font-size:12px;color:var(--muted)}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 12px}
    .tab{padding:6px 10px;border-radius:10px;border:1px solid var(--border);cursor:pointer;color:var(--muted)}
    .tab.active{color:#001;background:var(--accent);border-color:transparent;font-weight:700}
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{border-bottom:1px dashed var(--border);padding:8px 6px;vertical-align:top}
    th{color:#aaccff;text-align:left}
    .footer{padding:10px 12px;color:var(--muted);border-top:1px solid var(--border);font-size:12px}
    .legend{
      position:absolute;right:16px;top:16px;z-index:10;background:rgba(255,255,255,.06);
      border:1px solid var(--border);border-radius:12px;padding:10px 12px
    }
  </style>
<meta content="no-referrer" name="referrer"/></head>
<body>
<div class="wrap">
<div id="map"></div>
</div>
<div class="topbar">
<h1>é«˜æ ¡ Ã— ä¼ä¸š åˆä½œåœ°å›¾</h1>
<div class="hint">æ‚¬åœçœ‹çœä»½é«˜æ ¡ï¼›ç‚¹å‡»çœä»½è¿›å…¥è¯¦æƒ…ï¼›ç‚¹å‡»é«˜æ ¡çœ‹ä¸‰ç±»è¡¨æ ¼å¹¶ä¸‹è½½ Excelã€‚</div>
</div>
<!-- å³ä¾§ä¿¡æ¯é¢æ¿ -->
<aside aria-hidden="true" class="panel" id="panel">
<header>
<button class="btn" id="backBtn" style="display:none">â† è¿”å›</button>
<div class="crumb" id="crumb"></div>
<div class="title" id="panelTitle"></div>
</header>
<div class="content" id="panelContent"></div>
<div class="footer">å¯åœ¨ <span class="pill">data</span> é‡Œå¢åˆ é«˜æ ¡ä¸è¡¨æ ¼ï¼›Excelæ”¾åˆ° <span class="pill">./excels/</span> ç›®å½•å³å¯è‡ªåŠ¨é“¾æ¥ã€‚</div>
</aside>
<!-- ECharts -->
<script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
<script>
    /** --------------------------
     *  æ•°æ®åŒºï¼ˆç¤ºä¾‹ï¼Œå¯è‡ªè¡Œå¢åˆ æ”¹ï¼‰
     *  æ¯æ‰€é«˜æ ¡ä¸€ä¸ª Excelï¼ˆ3 ä¸ªå·¥ä½œè¡¨ï¼šåˆä½œä¼ä¸š/ä¼˜åŠ¿å­¦ç§‘/å­¦æ ¡ä¸“å®¶ï¼‰
     * ------------------------- */
  const data = {
      "æµ™æ±Ÿçœ": {
        universities: [
          {
            id: "HDU",
            name: "æ­å·ç”µå­ç§‘æŠ€å¤§å­¦",
            website: "https://www.hdu.edu.cn/",
            excel: "excels/AA-ä¸é«˜æ ¡å·²åˆä½œäººæ‰é¡¹ç›®ç»Ÿè®¡è¡¨ï¼ˆæŒç»­æ›´æ–°ï¼‰20241210.xlsx",
            enterprises: [
              { ä¼ä¸š: "æµ·åº·å¨è§†", åˆä½œæ–¹å‘: "è®¡ç®—æœºè§†è§‰/åµŒå…¥å¼AI", é¡¹ç›®é˜¶æ®µ: "è”åˆå®éªŒå®¤", è”ç³»äºº: "å¼ **" },
              { ä¼ä¸š: "é˜¿é‡Œäº‘", åˆä½œæ–¹å‘: "äº‘åŸç”Ÿ/å¤§æ•°æ®/AIå¹³å°", é¡¹ç›®é˜¶æ®µ: "è”åˆè¯¾é¢˜ï¼ˆçœéƒ¨çº§ï¼‰", è”ç³»äºº: "æ**" },
              { ä¼ä¸š: "å¤§åè‚¡ä»½", åˆä½œæ–¹å‘: "æ™ºèƒ½æ„ŸçŸ¥/è¾¹ç¼˜è®¡ç®—", é¡¹ç›®é˜¶æ®µ: "åœ¨ç ”", è”ç³»äºº: "ç‹**" }
            ],
            disciplines: [
              { å­¦ç§‘: "ä¿¡æ¯ä¸é€šä¿¡å·¥ç¨‹", å­¦ç§‘çº§åˆ«: "å›½å®¶ä¸€çº§", ä¼˜åŠ¿è¯´æ˜: "é€šä¿¡ä¸ä¿¡æ¯ç³»ç»Ÿã€ä¿¡å·ä¸ä¿¡æ¯å¤„ç†" },
              { å­¦ç§‘: "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯", å­¦ç§‘çº§åˆ«: "çœé‡ç‚¹", ä¼˜åŠ¿è¯´æ˜: "äººå·¥æ™ºèƒ½ã€è½¯ä»¶å·¥ç¨‹ã€ç½‘å®‰" },
              { å­¦ç§‘: "æ§åˆ¶ç§‘å­¦ä¸å·¥ç¨‹", å­¦ç§‘çº§åˆ«: "çœé‡ç‚¹", ä¼˜åŠ¿è¯´æ˜: "å·¥ä¸šæ§åˆ¶ã€æœºå™¨äºº" }
            ],
            experts: [
              { å§“å: "é™ˆæŸæŸ", èŒç§°: "æ•™æˆ/åšå¯¼", ç ”ç©¶æ–¹å‘: "æœºå™¨è§†è§‰ã€ç›®æ ‡æ£€æµ‹", è”ç³»æ–¹å¼: "chen@example.edu.cn" },
              { å§“å: "ææŸæŸ", èŒç§°: "æ•™æˆ", ç ”ç©¶æ–¹å‘: "é€šä¿¡ç¼–ç ã€5G/6G", è”ç³»æ–¹å¼: "li@example.edu.cn" },
              { å§“å: "å‘¨æŸ", èŒç§°: "å‰¯æ•™æˆ", ç ”ç©¶æ–¹å‘: "å·¥ä¸šæ§åˆ¶ä¸ç³»ç»Ÿ", è”ç³»æ–¹å¼: "zhou@example.edu.cn" }
            ]
          },
          {
            id: "ZJU",
            name: "æµ™æ±Ÿå¤§å­¦",
            website: "https://www.zju.edu.cn/",
            excel: "excels/AA-ä¸é«˜æ ¡å·²åˆä½œäººæ‰é¡¹ç›®ç»Ÿè®¡è¡¨ï¼ˆæŒç»­æ›´æ–°ï¼‰20241210.xlsx",
            enterprises: [
              { ä¼ä¸š: "é˜¿é‡Œå·´å·´", åˆä½œæ–¹å‘: "å¤šæ¨¡æ€å¤§æ¨¡å‹/æ¨èç³»ç»Ÿ", é¡¹ç›®é˜¶æ®µ: "ä¼ä¸šæèµ +è”åˆç ”ç©¶é™¢", è”ç³»äºº: "åˆä½œåŠ" },
              { ä¼ä¸š: "ä¹‹æ±Ÿå®éªŒå®¤", åˆä½œæ–¹å‘: "æ™ºèƒ½è®¡ç®—/ç½‘ç»œç©ºé—´å®‰å…¨", é¡¹ç›®é˜¶æ®µ: "è”åˆæ”»å…³", è”ç³»äºº: "é¡¹ç›®ç§˜ä¹¦" },
              { ä¼ä¸š: "å‰åˆ©æ±½è½¦", åˆä½œæ–¹å‘: "æ™ºèƒ½é©¾é©¶/è½¦è·¯ååŒ", é¡¹ç›®é˜¶æ®µ: "äº§ä¸šåŒ–è¯•ç‚¹", è”ç³»äºº: "å¯¹æ¥äºº" }
            ],
            disciplines: [
              { å­¦ç§‘: "è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯", å­¦ç§‘çº§åˆ«: "ä¸€æµå­¦ç§‘A+", ä¼˜åŠ¿è¯´æ˜: "AIã€ç³»ç»Ÿè½¯ä»¶ã€å›¾å½¢å­¦" },
              { å­¦ç§‘: "ä¿¡æ¯ä¸ç”µå­å·¥ç¨‹", å­¦ç§‘çº§åˆ«: "ä¸€æµå­¦ç§‘A", ä¼˜åŠ¿è¯´æ˜: "å¾®ç”µå­ã€é€šä¿¡ã€ä¿¡å·å¤„ç†" },
              { å­¦ç§‘: "ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹", å­¦ç§‘çº§åˆ«: "ä¸€æµå­¦ç§‘A", ä¼˜åŠ¿è¯´æ˜: "åŒ»å­¦æˆåƒã€ç²¾å‡†åŒ»ç–—" }
            ],
            experts: [
              { å§“å: "ç‹æŸæŸ", èŒç§°: "é™¢å£«", ç ”ç©¶æ–¹å‘: "äººå·¥æ™ºèƒ½ä¸å¤§æ•°æ®", è”ç³»æ–¹å¼: "contact@zju.edu.cn" },
              { å§“å: "èµµæŸæŸ", èŒç§°: "æ•™æˆ", ç ”ç©¶æ–¹å‘: "èŠ¯ç‰‡ä¸ç³»ç»Ÿ", è”ç³»æ–¹å¼: "chip@zju.edu.cn" },
              { å§“å: "å­™æŸ", èŒç§°: "ç ”ç©¶å‘˜", ç ”ç©¶æ–¹å‘: "è‡ªåŠ¨é©¾é©¶", è”ç³»æ–¹å¼: "auto@zju.edu.cn" }
            ]
          }
        ]
      }

};

    /** ------------ å·¥å…·å‡½æ•° -------------- */
    const $ = (sel)=>document.querySelector(sel);
    const $$ = (sel)=>Array.from(document.querySelectorAll(sel));
    function createEl(tag, attrs={}, children=[]){
      const el = document.createElement(tag);
      Object.entries(attrs).forEach(([k,v])=>{
        if(k==='class') el.className=v;
        else if(k==='html') el.innerHTML=v;
        else el.setAttribute(k,v);
      });
      children.forEach(c=>el.appendChild(c));
      return el;
    }
    function renderTable(objArray){
      if(!objArray || !objArray.length) return createEl('div',{class:'meta',html:'æš‚æ— æ•°æ®'});
      const cols = Object.keys(objArray[0]);
      const table = createEl('table');
      const thead = createEl('thead');
      const trh = createEl('tr');
      cols.forEach(c=>trh.appendChild(createEl('th',{html:c})));
      thead.appendChild(trh); table.appendChild(thead);
      const tbody = createEl('tbody');
      objArray.forEach(row=>{
        const tr = createEl('tr');
        cols.forEach(c=>tr.appendChild(createEl('td',{html:String(row[c] ?? '')})));
        tbody.appendChild(tr);
      });
      table.appendChild(tbody);
      return table;
    }

    /** ------------ é¢æ¿æ¸²æŸ“ -------------- */
    const panel = $('#panel'), panelTitle = $('#panelTitle'), panelContent = $('#panelContent'), crumb = $('#crumb'), backBtn = $('#backBtn');
    const openPanel = ()=>{ panel.classList.add('open'); panel.setAttribute('aria-hidden','false'); };
    const closePanel = ()=>{ panel.classList.remove('open'); panel.setAttribute('aria-hidden','true'); };

    function renderProvince(province){
      openPanel();
      crumb.textContent = province;
      panelTitle.textContent = 'é«˜æ ¡åˆ—è¡¨';
      backBtn.style.display='none';
      panelContent.innerHTML = '';
      const box = createEl('div');
      const searchWrap = createEl('div',{class:'search'});
      const input = createEl('input',{placeholder:'æœç´¢é«˜æ ¡åâ€¦'});
      searchWrap.appendChild(input);
      box.appendChild(searchWrap);

      const list = createEl('div',{class:'uni-list'});
      const arr = (data[province]?.universities ?? []);
      function draw(filter=''){
        list.innerHTML='';
        arr.filter(u=>u.name.includes(filter)).forEach(u=>{
          const card = createEl('div',{class:'card'});
          card.appendChild(createEl('h3',{html:u.name}));
          const meta = createEl('div',{class:'meta',html:`å®˜ç½‘ï¼š<a href="${u.website}" target="_blank" rel="noopener">${u.website}</a>`});
          card.appendChild(meta);
          const btns = createEl('div',{class:'btns'});
          const viewBtn = createEl('a',{class:'btn primary',href:'javascript:void(0)'},[document.createTextNode('æŸ¥çœ‹è¯¦æƒ…')]);
          viewBtn.addEventListener('click',()=>renderUniversity(province,u));
          const xlsBtn = createEl('a',{class:'btn',href:u.excel,target:'_blank',rel:'noopener',title:'ä¸‹è½½Excelï¼ˆä¸‰è¡¨åˆä¸€ï¼‰'},[document.createTextNode('ä¸‹è½½Excel')]);
          btns.appendChild(viewBtn); btns.appendChild(xlsBtn);
          card.appendChild(btns);
          list.appendChild(card);
        });
        if(!list.children.length){
          list.appendChild(createEl('div',{class:'meta',html:'æœªæ‰¾åˆ°åŒ¹é…é«˜æ ¡'}));
        }
      }
      input.addEventListener('input',()=>draw(input.value.trim()));
      draw();
      box.appendChild(list);
      panelContent.appendChild(box);
    }

    function renderUniversity(province, u){
      openPanel();
      crumb.textContent = province + " / " + u.name;
      panelTitle.textContent = 'åˆä½œè¯¦æƒ…';
      backBtn.style.display='inline-flex';
      backBtn.onclick = ()=>renderProvince(province);
      panelContent.innerHTML = '';

      // tabs
      const tabs = createEl('div',{class:'tabs'});
      const t1 = createEl('button',{class:'tab active'},[document.createTextNode('åˆä½œä¼ä¸š')]);
      const t2 = createEl('button',{class:'tab'},[document.createTextNode('ä¼˜åŠ¿å­¦ç§‘')]);
      const t3 = createEl('button',{class:'tab'},[document.createTextNode('å­¦æ ¡ä¸“å®¶')]);
      tabs.appendChild(t1);tabs.appendChild(t2);tabs.appendChild(t3);

      const sec1 = createEl('div',{},[renderTable(u.enterprises)]);
      const sec2 = createEl('div',{style:'display:none'},[renderTable(u.disciplines)]);
      const sec3 = createEl('div',{style:'display:none'},[renderTable(u.experts)]);

      const actions = createEl('div',{class:'btns',style:'margin:10px 0'});
      const siteBtn = createEl('a',{class:'btn',href:u.website,target:'_blank',rel:'noopener'},[document.createTextNode('é«˜æ ¡å®˜ç½‘')]);
      const xlsBtn = createEl('a',{class:'btn primary',href:u.excel,target:'_blank',rel:'noopener'},[document.createTextNode('ä¸‹è½½Excelï¼ˆå«ä¸‰è¡¨ï¼‰')]);
      actions.appendChild(siteBtn); actions.appendChild(xlsBtn);

      function activate(tabIndex){
        [t1,t2,t3].forEach((t,i)=>t.classList.toggle('active', i===tabIndex));
        [sec1,sec2,sec3].forEach((s,i)=>s.style.display = (i===tabIndex)?'block':'none');
      }
      t1.onclick=()=>activate(0); t2.onclick=()=>activate(1); t3.onclick=()=>activate(2);

      panelContent.appendChild(tabs);
      panelContent.appendChild(actions);
      panelContent.appendChild(sec1);
      panelContent.appendChild(sec2);
      panelContent.appendChild(sec3);
    }

    /** ------------ åœ°å›¾ -------------- */
    const chart = echarts.init(document.getElementById('map'));
    const chinaGeoJSONUrl = 'https://geo.datav.aliyun.com/areas_v3/bound/geojson?code=100000_full';

    fetch(chinaGeoJSONUrl).then(r=>r.json()).then(geoJson=>{
      echarts.registerMap('china', geoJson);
      const seriesData = geoJson.features.map(f=>{
        const name = f.properties.name;
        const list = data[name]?.universities || [];
        return { name, value: list.length, universities: list.map(u=>u.name) };
      });
      const maxv = Math.max(1, ...seriesData.map(d=>d.value||0));

      const option = {
        backgroundColor: 'transparent',
        tooltip: {
          trigger:'item',
          appendToBody:true,
          formatter: (p)=>{
            const unis = (p.data?.universities||[]).slice(0,6);
            const lines = unis.length ? unis.map(n=>'Â· '+n).join('<br/>') : 'æš‚æ— æ”¶å½•é«˜æ ¡';
            return `<div style="min-width:220px">
              <strong>${p.name}</strong><br/>
              é«˜æ ¡æ•°é‡ï¼š${p.data?.value||0}<br/>
              ${lines}<br/>
              <span style="color:#9fb2d9">æç¤ºï¼šç‚¹å‡»çœä»½æŸ¥çœ‹è¯¦æƒ…</span>
            </div>`;
          }
        },
        visualMap:{
          type:'continuous',min:0,max:maxv, right:16, bottom:16, text:['å¤š','å°‘'],
          inRange:{ color:['#2e7bd1','#42c2ff','#a0f1ff'] },
          textStyle:{ color:'#fff' }, calculable:true
        },
        geo:{
          map:'china', roam:true, zoom:1.05,
          label:{ show:false },
          itemStyle:{ borderColor:'#3aa0ff', borderWidth:0.6, areaColor:'#143657' },
          emphasis:{
            label:{ show:true, color:'#fff', fontWeight:'bold' },
            itemStyle:{ areaColor:'#46e1ff', borderColor:'#fff', borderWidth:1.2, shadowBlur:30, shadowColor:'rgba(0,0,0,.45)' }
          }
        },
        series:[{ type:'map', map:'china', geoIndex:0, data:seriesData }]
      };
      chart.setOption(option);
      chart.on('click', (p)=> renderProvince(p.name));
      window.addEventListener('resize', ()=>chart.resize());
    });
  </script>
<div aria-label="é¡¹ç›®åˆä½œéœ€æ±‚è¡¨ä¸‹è½½" class="download-entry" style="position: fixed; left: 16px; bottom: 16px; z-index: 50;
            background: rgba(0,0,0,0.7); padding: 12px 14px;
            border-radius: 8px; max-width: 260px; color: #fff; font-size: 14px; line-height: 1.5;">
<p style="margin: 0 0 8px 0;">
    ğŸ“Š åœ¨è¿™é‡Œæ‚¨å¯ä»¥ä¸‹è½½ã€Šé¡¹ç›®åˆä½œéœ€æ±‚è¡¨ã€‹ï¼Œ
    è¯¥è¡¨æ±‡æ€»äº†å„åœ°ä¼ä¸šä¸é«˜æ ¡çš„åˆä½œéœ€æ±‚ï¼Œ
    æ–¹ä¾¿å¿«é€Ÿäº†è§£åˆä½œæ–¹å‘ä¸èµ„æºå¯¹æ¥æƒ…å†µã€‚
  </p>
<a download="" href="excels/é¡¹ç›®åˆä½œéœ€æ±‚è¡¨-æ±‡æ€»è¡¨-20240307.xlsx" rel="noopener" style="display: inline-block; padding: 8px 12px;
            background: #007bff; color: #fff;
            border-radius: 4px; text-decoration: none;" target="_blank">
    â¬‡ï¸ ä¸‹è½½é¡¹ç›®åˆä½œéœ€æ±‚è¡¨ï¼ˆExcelï¼‰
  </a>
</div>
</body>
</html>
